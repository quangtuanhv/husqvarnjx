jQuery(document).ready(function(e){jQuery(document).on("change","#betrs-shipping_options-setup",function(t){t.preventDefault();var r=jQuery(this).parent();r.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var o={action:"betrs_add_table_rates_row",optionCount:jQuery(this).val()};return e.post(ajaxurl,o,function(e){jQuery(r).replaceWith(e)}),!1}),jQuery(document).on("click","#add_table_rates_row",function(t){t.preventDefault(),jQuery(this).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r=jQuery(this),o=jQuery("#BETRS-table-rates-parent"),n=[];jQuery("#BETRS-table-rates-parent").find(".single-row").each(function(){n.push(jQuery(this).attr("data-row_id"))});var a={action:"betrs_add_table_rates_row",rowID:Math.max.apply(Math,n)+1};return e.post(ajaxurl,a,function(e){jQuery(o).append(e),jQuery(document).trigger("betrs_update_sortables"),r.find(".blockUI").remove()}),!1}),jQuery(document).on("click","#BETRS-table-rates-parent a.betrs_add_ops",function(t){t.preventDefault(),jQuery(this).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r=jQuery(this),o=jQuery(this).closest(".single-row").find(".wp-list-table.table_rates"),n=jQuery(this).closest(".single-row").attr("data-row_id"),a=o.find("tbody > tr").length;1==a&&o.find("tbody").children("tr:first").hasClass("no-items")&&a--;var s={action:"betrs_add_table_costs_row",optionID:n,rowID:a};e.post(ajaxurl,s,function(e){jQuery(o).append(e),void 0!=o.find("tr.no-items")&&o.find("tr.no-items").remove(),r.find(".blockUI").remove()})}),jQuery(document).on("click","#BETRS-table-rates-parent a.add_table_cost_op",function(t){t.preventDefault(),jQuery(this).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r=jQuery(this),o=(jQuery(this).closest("div.cost_op"),{action:"betrs_add_extra_costs_op",optionID:jQuery(this).closest(".single-row").attr("data-row_id"),rowID:jQuery(this).closest("tr").index()});e.post(ajaxurl,o,function(e){jQuery(r).before(e),r.find(".blockUI").remove()})}),jQuery(document).on("change","#BETRS-table-rates-parent select.cost_type",function(t){t.preventDefault();var r=jQuery(this),o=r.parent().parent(),n=r.val();o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var a={action:"betrs_add_costs_op_details",selected:n,optionID:jQuery(this).closest(".single-row").attr("data-row_id"),rowID:jQuery(this).closest("tr").index()};e.post(ajaxurl,a,function(e){o.find(".cost_op_extras").length>0?o.find(".cost_op_extras").replaceWith(e):jQuery(r).parent().after(e),o.find(".blockUI").remove()})}),jQuery(document).on("change","#BETRS-table-rates-parent select.cost_op_every",function(e){e.preventDefault();var t=jQuery(this).parent().find("select.cost_op_every_dim");"dimensions"==jQuery(this).val()?t.show():t.hide()}),jQuery(document).on("click","#BETRS-table-rates-parent a.add_table_condition_op",function(t){t.preventDefault(),jQuery(this).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r=jQuery(this),o=(jQuery(this).closest("div.condition_op"),{action:"betrs_add_extra_conditions_op",optionID:jQuery(this).closest(".single-row").attr("data-row_id"),rowID:jQuery(this).closest("tr").index()});e.post(ajaxurl,o,function(e){jQuery(r).before(e),jQuery(document).trigger("betrs_update_options"),r.find(".blockUI").remove()})}),jQuery(document).on("change","#BETRS-table-rates-parent select.cond_type",function(t){t.preventDefault();var r=jQuery(this),o=r.closest("div.condition_op"),n=r.val();o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var a={action:"betrs_add_conds_op_details",selected:n,optionID:jQuery(this).closest(".single-row").attr("data-row_id"),rowID:jQuery(this).closest("tr").index(),condID:o.parent().find("div.condition_op").length-1};e.post(ajaxurl,a,function(e){o.find(".cond_op_extras").length>0?o.find(".cond_op_extras").replaceWith(e):jQuery(r).parent().after(e),jQuery(document).trigger("betrs_update_options"),o.find(".blockUI").remove(),o.trigger("wc-enhanced-select-init")})}),jQuery(document).on("change","#BETRS-table-rates-parent select.cost_op_extra",function(e){e.preventDefault();var t=jQuery(this),r=(t.closest("div.condition_op"),t.val()),o=t.parent().find("select.cost_op_extra_secondary");"dimensions"==r?o.css("display","inline"):o.css("display","none")}),jQuery(document).on("click","#BETRS-table-rates-parent span.betrs_delete_ops_cond",function(){if(confirm(betrs_data.text_delete_confirmation))jQuery(this).closest("div.condition_op").remove();return!1}),jQuery(document).on("click","#BETRS-table-rates-parent span.betrs_delete_ops_cost",function(){if(confirm(betrs_data.text_delete_confirmation))jQuery(this).closest("div.cost_op").remove();return!1}),jQuery(document).on("click","#BETRS-table-rates-parent a.betrs_delete_ops",function(){return confirm(betrs_data.text_delete_confirmation)&&(jQuery(this).closest(".single-row").find(".wp-list-table.table_rates tbody tr th input:checked").each(function(e,t){jQuery(t).closest("tr").remove()}),jQuery(this).closest(".single-row").find(".wp-list-table.table_rates tbody").children("tr").each(function(e){jQuery(this).find("td:not(:first-child, :last-child, :nth-last-child(2))").find("input,textarea,select").each(function(){str=this.name;for(var t=-1,r=2;r--&&t++<str.length&&!((t=str.indexOf("[",t))<0););removeID=str.substring(0,t),newName=removeID+"["+e+"][]",this.name=newName})})),!1}),jQuery(document).on("click","#BETRS-table-rates-parent a.remove-shipping-option",function(){if(confirm(betrs_data.text_delete_confirmation))jQuery(this).closest(".single-row").remove();return!1}),jQuery(document).on("betrs_update_sortables",function(){0!=jQuery(".wp-list-table.table_rates tbody").length&&jQuery(".wp-list-table.table_rates tbody").sortable({handle:"td.column-sort div.move_row",cursor:"move",placeholder:"row-placeholder ui-corner-all",helper:function(t,r){var o=r.children(),n=r.clone();return n.children().each(function(t){e(this).width(o.eq(t).width())}),n},stop:function(e,t){jQuery(this).children("tr").each(function(e){jQuery(this).find("td:not(:first-child, :last-child, :nth-last-child(2))").find("input,textarea,select").each(function(){str=this.name;for(var t=-1,r=2;r--&&t++<str.length&&!((t=str.indexOf("[",t))<0););if(removeID=str.substring(0,t),this.attributes.multiple){for(var t=-1,r=3;r--&&t++<str.length&&!((t=str.indexOf("[",t))<0););cidx_str=str.substring(t+1),j=cidx_str.indexOf("]"),cidx=cidx_str.substring(0,j),newName=removeID+"["+e+"]["+cidx+"][]"}else newName=removeID+"["+e+"][]";this.name=newName})})}})}).trigger("betrs_update_sortables")});